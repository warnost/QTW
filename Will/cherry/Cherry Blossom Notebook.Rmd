---
title: "Cherry Blossom Workbook"
output: html_notebook
---

This is a codebook that goes through code from chapter two of the textbook. The data was created from a jupyter notebook ("unit-8 scrape") provided by professor Slater with some minor modifications. These data objects contain the raw text for each year of the Cherry Blossom Race.

```{r}
## I would reccommend setting this to your working directory
setwd("C:/Users/William/OneDrive/MSDS_7331_QTW/cherry")

## Load the mens tables
load(file = "CBMenTextTables.rda")
print("List menTables read in")

## Load the womens tables
load(file = "CBWomenTextTables.rda")
print("List womenTables read in")
```

Next, the chapter starts with the men's data from 2012. We look at the first few rows to get an idea of the data structure.  
```{r}
els = menTables$"2012"
els[1:10]
```
Now lets look at 2011, is it the same?  
```{r}
els2011 = menTables$"2011"
els2011[1:10]
```

The headers are not the same. The structure of each year may be different so we are going to have to work through that. This first bit of code uses two different ways to find the spacer row that divides the data from the header.  
```{r}
eqIndex = grep("^===", els)
eqIndex
first3 = substr(els, 1, 3)
which(first3 == "===")
```

Now we are assigning the column names, spacer, and body to some variables using the indicies we found. Also we convert the column names to lower case.  
```{r}
spacerRow = els[eqIndex]
headerRow = els[eqIndex - 1]
body = els[ -(1:eqIndex) ]

headerRow = tolower(headerRow)
```

This code uses a regular expression to find the age column "ag" in the header row. It starts at position 49 and ends at position 50. Then it uses substr to extract age data from body using that fixed width. The youngest person running was 9 and the oldest was 89. There is one NA value.  
```{r}
ageStart = regexpr("ag", headerRow)
ageStart

age = substr(body, start = ageStart, stop = ageStart + 1)
head(age)

summary(as.numeric(age))
```

```{r}
blankLocs = gregexpr(" ", spacerRow)
blankLocs

searchLocs = c(0, blankLocs[[1]])

Values = mapply(substr, list(body), 
                start = searchLocs[ -length(searchLocs)] + 1, 
                stop = searchLocs[ -1 ] - 1)
```

